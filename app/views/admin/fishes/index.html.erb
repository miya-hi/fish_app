<h1>《管理者ページ》魚の一覧</h1>
<table>
  <tr>
    <th>行</th>
    <th>おさかな名</th>
    <th></th>
  </tr>
  <tr>
    <td><%= select_tag'line',options_for_select([["あ","あ"],["か","か"],["さ","さ"],["た","た"],["な","な"],["は","は"],["ま","ま"],["や","や"],["ら","ら"],["わ","わ"]]) %></td>
    <td><%= select_tag'name',options_from_collection_for_select(@fishes, :id, :name) %></td>
    <td><button><a href="javascript:void(0)" id="edit-fish-btn">選択した魚の編集</a></button></td>
<!-- button_to ('選択した魚を編集削除', 'javascript:void(0);', :id => :edit-fish-btn)  -->
  </tr>
</table>
<br>
<%= link_to '戻る', admin_users_path, method: :get %>
<script>
  $(function() {
    $('#line').change(function() {
      $.get({
        url: "/api/fishes.json",
        data: { line: $('#line').has('option:selected').val() }
      }).then(function(data) {
        console.log('data=%o', data);
        const $nameSelect = $('#name');
        $nameSelect.find('option').remove();
        data.fishes.forEach(function(fish) {
          // $nameSelect.append(`<option value="${fish.id}">${fish.name}</option>`);
          $nameSelect.append('<option value="' + fish.id + '">' + fish.name + '</option>'); //IEでも使える
        });
      });
    });
  });
  $(function(){
    $('#edit-fish-btn').click(function() {
      // 選択中の魚のIDを取得
      const fishId = $('#name').val();
  　　 console.log("fishId=%o", fishId);

      // 選択中であれば編集画面へ遷移
      if (fishId) {
        window.location = '/admin/fishes/' + fishId + '/edit';
      } else {
        console.log("魚を選択してください。");
      }
    });
  });
  // $(function() {
  //   $('#name').on('change', function() {
  //     console.log($nameSelect);
  //     });
  //   });
  </script>


<!-- <script>
$(function(){
  $('edit-fish-btn').click(function() {
    // 選択中の魚のIDを取得
    const fishId = $('#name').val();
　　 console.log("fishId=%o", fishId);

    // 選択中であれば編集画面へ遷移
    if (fishId) {
      window.location = '/admin/fish/' + fishId + '/edit';
    } else {
      console.log("魚を選択してください。");
    }
  });
});
</script> -->
  <!-- $.get({
}).then(function(data) {
  console.log('data=%o', data);
}) -->
<!-- // 魚の名前一覧のプルダウン要素を取得
const $nameSelect = $('#name');

// 現在の魚一覧を削除
$nameSelect.find('option').remove();

html オプションタグ　探したオプションタグ

$nameSelect.append(`<option value="${fish.id}">${fish.name}</option>`);

 `を使う：${}の中に変数を埋め込める IEは古いので認識されない -->
